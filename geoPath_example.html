<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>GeoPath example</title>
    <script type="text/javascript" src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <h2>geoPath example</h2>
    <div id="map"></div>

    <h2>References</h2>
    <ul>
      <li><a href="https://d3js.org/d3-geo/path">geoPath</a></li>
      <li><a href="https://en.wikipedia.org/wiki/GeoJSON">GeoJSON</a></li>
      <li>
        <a href="https://github.com/johan/world.geo.json/"
          >sample geojson files</a
        >
      </li>
    </ul>

    <script type="text/javascript">
      /***************************
       * create svg
       **************************/

      // Set up the dimensions of the chart
      const width = 500;
      const height = 500;

      // Create an SVG element
      const svg = d3
        .select("div#map")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      /****************************
       * map projection
       *****************************/
      const projection = d3
        .geoMercator()
        .scale(width / 2 / Math.PI)
        .rotate([0, 0])
        .center([0, 0])
        .translate([width / 2, height / 2]);

      /*******************************
       * Create a path generator
       **********************************/
      const path = d3.geoPath(projection);

      /*******************************
       * urls of geoJSON files
       * ****************************/

      const usa =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/USA.geo.json";
      const india =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/IND.geo.json";
      const canada =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/CAN.geo.json";
      const mexico =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/MEX.geo.json";
      const china =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/CHN.geo.json";
      const japan =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/JPN.geo.json";
      const australia =
        "https://raw.githubusercontent.com/johan/world.geo.json/master/countries/AUS.geo.json";

      const countries = [usa, india, canada, mexico, china, japan, australia];

      /********************************************
       * draw a map
       ******************************************/
      countries.forEach((url) => {
        d3.json(url).then((json) => {
          // output
          console.log(`downloaded ${url}`);
          console.log("json.features", json.features);

          // create a map for each country
          svg
            .append("g")
            .selectAll("path")
            .data(json.features)
            .enter()
            .append("path")
            .attr("d", path)
            .attr("fill", "lightblue")
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .append("title") // tooltip
            .text((d, i) => d.properties.name);
        });
      });
    </script>
  </body>
</html>
